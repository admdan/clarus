<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Employee Identity Portal</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/htmx.org@1.9.5"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <div class="max-w-7xl mx-auto py-10 px-4">
    <h2 class="text-3xl font-semibold mb-6">Employee Identity Portal (EIP)</h2>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="space-y-4 mb-6">
        {% for category, message in messages %}
          <div class="px-4 py-3 rounded shadow text-sm font-medium
                      {% if category == 'success' %}bg-green-100 text-green-800
                      {% elif category == 'danger' %}bg-red-100 text-red-800
                      {% elif category == 'warning' %}bg-yellow-100 text-yellow-800
                      {% else %}bg-gray-100 text-gray-800{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
    {% endwith %}

    <!-- Filter Form -->
    <form hx-get="{{ url_for('eip.eip_dashboard') }}" hx-target="#request-table" hx-push-url="true" class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
      <input type="text" name="search" class="border rounded px-3 py-2 w-full" placeholder="Search username or email" value="{{ search_query or '' }}">

      <select name="status" class="border rounded px-3 py-2 w-full">
        <option value="">All Status</option>
        <option value="Pending" {% if status_filter == 'Pending' %}selected{% endif %}>Pending</option>
        <option value="Approved" {% if status_filter == 'Approved' %}selected{% endif %}>Approved</option>
        <option value="Declined" {% if status_filter == 'Declined' %}selected{% endif %}>Declined</option>
      </select>

      <button type="submit" class="bg-blue-600 text-white rounded px-4 py-2 hover:bg-blue-700 transition">Filter</button>
      <a href="{{ url_for('eip.eip_dashboard') }}" class="text-blue-600 border border-blue-600 rounded px-4 py-2 text-center hover:bg-blue-50 transition">Reset</a>
    </form>

    <!-- Table Section -->
    <div id="request-table">
      {% include 'partials/eip_table.html' %}
    </div>

    <a href="{{ url_for('routes.portal') }}" class="inline-block mt-6 text-blue-600 hover:underline">‚Üê Back to Portal</a>
  </div>
</body>
</html>
